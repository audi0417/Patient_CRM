# 後台管理腳本

## 資料庫初始化

### 使用方式

系統提供一鍵初始化腳本，會自動建立管理員帳號、標籤、群組和模擬患者資料。

#### 方法 1: 使用 npm 腳本 (推薦)

```bash
npm run init-db
```

#### 方法 2: 直接執行 Node.js 腳本

```bash
node scripts/initDatabase.js
```

### 初始化內容

執行腳本後，系統會自動建立：

1. **管理員帳號**
   - 帳號: `admin`
   - 密碼: `Admin123`
   - 角色: 管理員
   - 狀態: 已啟用

2. **標籤** (10個)
   - 糖尿病、高血壓、減重計畫、健身、營養諮詢
   - 運動員、心臟病史、產後恢復、高血脂、睡眠障礙

3. **群組** (4個)
   - 2025減肥課程
   - 慢性病管理
   - 運動訓練班
   - 營養調理

4. **模擬患者** (8位)
   - 包含完整的基本資料
   - 自動分配到相關群組
   - 包含標籤和健康檔案

5. **健康數據**
   - 體組成記錄 (每位患者 8-15 筆)
   - 生命徵象記錄 (每位患者 6-12 筆)
   - 涵蓋過去 180 天的歷史數據

### 資料儲存位置

所有資料會儲存在 `data/` 目錄下：

```
data/
├── users.json              # 使用者帳號
├── tags.json               # 標籤
├── groups.json             # 群組
├── patients.json           # 患者基本資料
├── bodyComposition.json    # 體組成記錄
├── vitalSigns.json         # 生命徵象記錄
├── appointments.json       # 預約記錄 (空)
├── goals.json              # 健康目標 (空)
└── initialAssessments.json # 初始評估 (空)
```

### 執行結果範例

```bash
$ npm run init-db

═══════════════════════════════════════
  初始化資料庫
═══════════════════════════════════════

✅ 建立管理員帳號: admin / Admin123
✅ 建立 10 個標籤
✅ 建立 4 個群組
✅ 建立 8 位模擬患者
✅ 生成 94 筆體組成記錄
✅ 生成 64 筆生命徵象記錄

⏳ 正在儲存資料...

═══════════════════════════════════════
  資料初始化完成！
═══════════════════════════════════════

📊 資料摘要:
   管理員帳號: 1 個 (admin / Admin123)
   標籤: 10 個
   群組: 4 個
   患者: 8 位
   體組成記錄: 94 筆
   生命徵象記錄: 64 筆

📁 資料已儲存至 data/ 目錄
🚀 請重新載入應用程式開始使用

🔑 登入資訊:
   帳號: admin
   密碼: Admin123
```

### 模擬患者資料

初始化腳本會建立以下模擬患者：

1. **王小明** - 糖尿病、高血壓患者（慢性病管理組）
2. **李美玲** - 減重、健身學員（2025減肥課程、運動訓練班）
3. **陳建國** - 高血壓、心臟病史患者（慢性病管理組）
4. **林雅婷** - 運動員（運動訓練班、營養調理組）
5. **張志豪** - 減重學員（2025減肥課程）
6. **黃淑芬** - 糖尿病患者（慢性病管理、營養調理組）
7. **劉俊傑** - 健身增肌（運動訓練班）
8. **吳佩珊** - 產後恢復（營養調理組）

每位患者都包含：
- 完整的基本資料（姓名、性別、出生日期、聯絡方式等）
- 健康檔案（身高、體重、目標體重、活動量）
- 過去數月的體組成變化記錄
- 定期的生命徵象測量數據
- 相關的標籤和群組分類

### 常見問題

**Q: 初始化會覆蓋現有資料嗎?**
A: 是的，每次執行都會完全重新建立資料庫。請在執行前備份重要資料。

**Q: 如何清除所有資料?**
A: 直接刪除 `data/` 目錄即可，或重新執行 `npm run init-db`。

**Q: 可以修改初始化的資料嗎?**
A: 可以編輯 `scripts/initDatabase.js` 來自訂初始資料。

**Q: 忘記管理員密碼怎麼辦?**
A: 重新執行 `npm run init-db` 即可重置為 admin / Admin123。

**Q: 如何添加更多模擬患者?**
A: 編輯 `scripts/initDatabase.js` 中的 `mockData` 陣列，添加新的患者資料。

### 開發建議

1. **首次啟動**: 執行 `npm run init-db` 來建立完整的測試資料
2. **測試功能**: 使用模擬資料來測試系統各項功能
3. **重置資料**: 如需重新開始，隨時可以重新執行初始化
4. **正式使用**: 正式使用前，請清空模擬資料，手動建立真實資料

### 注意事項

1. 此腳本會**完全覆蓋**現有的資料庫
2. 密碼使用 SHA-256 雜湊加密
3. 所有日期和時間戳都使用 ISO 8601 格式
4. 群組與患者的關聯是雙向的（群組記錄患者ID，患者記錄群組ID）
5. 建議在開發環境使用，正式環境請謹慎執行

### 技術資訊

- Node.js 版本要求: v14+
- 密碼加密: SHA-256
- 資料格式: JSON
- 資料生成: 隨機但符合實際情況的測試數據

---

**更新日期**: 2025-11-05

# 如何匯入模擬患者資料

## 問題說明

您已經執行了 `npm run seed-patients` 腳本，這會在 `data/` 目錄建立 JSON 檔案。但是應用程式使用的是 **瀏覽器的 localStorage**，所以需要將 JSON 資料匯入到 localStorage 中。

## 快速匯入步驟（推薦）

### 1️⃣ 生成資料檔案

```bash
npm run seed-patients
```

這會建立以下檔案：
- `data/patients.json` - 12 位患者
- `data/bodyComposition.json` - 139 筆體組成記錄
- `data/vitalSigns.json` - 115 筆生命徵象記錄
- `data/appointments.json` - 59 筆預約
- `data/goals.json` - 18 個目標
- `data/initialAssessments.json` - 12 筆評估

### 2️⃣ 啟動開發伺服器

```bash
npm run dev
```

等待伺服器啟動完成（會顯示 "Local: http://localhost:8080/"）

### 3️⃣ 開啟導入頁面

在瀏覽器中前往：

```
http://localhost:8080/import-data.html
```

您會看到一個漂亮的導入介面，顯示：
- 📋 準備匯入 12 位患者及相關資料
- 按鈕：「開始匯入資料」

### 4️⃣ 點擊匯入

點擊「**開始匯入資料**」按鈕

系統會：
1. 從 `/data/` 目錄讀取所有 JSON 檔案
2. 將資料寫入瀏覽器的 localStorage
3. 顯示匯入成功訊息
4. 詢問是否要前往應用程式

### 5️⃣ 查看患者

點擊「是」或手動前往主應用程式：

```
http://localhost:8080/
```

現在您應該可以看到 **12 位患者**！

## 截圖說明

導入頁面會顯示：
```
🏥 匯入模擬患者資料
Patient CRM - 資料導入工具

📋 準備匯入的資料：
• 12 位模擬患者
• 139 筆體組成記錄
• 115 筆生命徵象記錄
• 59 筆預約記錄
• 18 個健康目標
• 12 筆初始評估

[開始匯入資料]  <-- 點這裡！
[清除所有資料]
```

## 常見問題

### Q1: 為什麼執行腳本後看不到患者？

**A:** 因為腳本只是建立 JSON 檔案，但應用程式讀取的是 localStorage。您需要使用導入工具將 JSON 資料匯入到 localStorage。

### Q2: 我可以重複匯入嗎？

**A:** 可以！導入工具會**覆蓋**現有資料。如果您想清除資料，點擊「清除所有資料」按鈕。

### Q3: 如果導入頁面打不開？

**A:** 確認：
1. 開發伺服器是否正在執行 (`npm run dev`)
2. 端口 8080 是否可用
3. 檢查 `public/import-data.html` 檔案是否存在

### Q4: 可以在 Electron 版本中使用嗎？

**A:** 可以！步驟相同：
1. 執行 `npm run seed-patients`
2. 執行 `npm run electron:dev`
3. 在 Electron 視窗中前往 `http://localhost:8080/import-data.html`
4. 點擊匯入

### Q5: 資料儲存在哪裡？

**A:**
- **瀏覽器版本**: localStorage（瀏覽器緩存）
- **Electron 版本**: 應該也是 localStorage，但可能會有檔案系統儲存（取決於設定）

### Q6: 如何確認資料已匯入？

**A:** 導入頁面會顯示統計資訊：
```
📊 目前資料統計
患者: 12 筆
體組成記錄: 139 筆
生命徵象記錄: 115 筆
預約記錄: 59 筆
健康目標: 18 筆
初始評估: 12 筆
```

## 手動方法（進階）

如果自動導入工具無法使用，您可以手動操作：

### 方法 1: 使用瀏覽器 Console

1. 開啟應用程式 `http://localhost:8080/`
2. 按 F12 開啟開發者工具
3. 切換到 Console 標籤
4. 執行以下程式碼：

```javascript
// 從 /data/ 載入並匯入所有資料
async function importAllData() {
  const files = {
    'hospital_crm_patients': 'patients.json',
    'hospital_crm_body_composition': 'bodyComposition.json',
    'hospital_crm_vital_signs': 'vitalSigns.json',
    'hospital_crm_appointments': 'appointments.json',
    'hospital_crm_goals': 'goals.json',
    'hospital_crm_assessments': 'initialAssessments.json'
  };

  for (const [key, filename] of Object.entries(files)) {
    const response = await fetch(`/data/${filename}`);
    const data = await response.json();
    localStorage.setItem(key, JSON.stringify(data));
    console.log(`✓ ${filename} 匯入完成`);
  }

  console.log('✅ 所有資料匯入完成！重新載入頁面即可查看。');
}

importAllData();
```

5. 重新載入頁面 (F5)

### 方法 2: 使用 Application 標籤

1. 開啟開發者工具 (F12)
2. 切換到 **Application** 標籤
3. 左側選擇 **Local Storage** → `http://localhost:8080`
4. 手動新增 key-value（較繁瑣，不推薦）

## 驗證匯入成功

匯入後，在應用程式中您應該能看到：

### 患者列表頁面
- 12 位患者，包含：
  - 王小明（男，40歲，糖尿病+高血壓）
  - 李美玲（女，35歲，減重計畫+健身）
  - 陳建國（男，47歲，高血壓+心臟病史）
  - ...等 9 位

### 患者詳細頁面
點擊任一患者可查看：
- 📊 健康數據圖表（體重、BMI 趨勢）
- 🎯 健康目標進度
- 📅 預約記錄（已完成和待完成）
- 💉 生命徵象記錄
- 📈 體組成記錄

## 清除資料

如果想重新開始：

1. 前往 `http://localhost:8080/import-data.html`
2. 點擊「**清除所有資料**」按鈕
3. 確認清除

或在 Console 執行：

```javascript
['hospital_crm_patients', 'hospital_crm_body_composition',
 'hospital_crm_vital_signs', 'hospital_crm_appointments',
 'hospital_crm_goals', 'hospital_crm_assessments'].forEach(key => {
  localStorage.removeItem(key);
});
console.log('✅ 資料已清除');
```

## 相關檔案

- 📄 [scripts/seedPatients.js](scripts/seedPatients.js) - 生成資料腳本
- 🌐 [public/import-data.html](public/import-data.html) - 導入工具頁面
- 📖 [SEED_DATA_README.md](SEED_DATA_README.md) - 詳細資料說明

## 需要幫助？

如果遇到問題：
1. 確認 `data/` 目錄下有所有 JSON 檔案
2. 確認開發伺服器正在運行
3. 檢查瀏覽器 Console 是否有錯誤訊息
4. 嘗試清除瀏覽器緩存後重試

---

**提示**: 使用導入工具是最簡單的方法！整個過程不到 30 秒即可完成。
